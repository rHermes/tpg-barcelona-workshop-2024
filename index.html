<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/base16/solarized-light.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <h1>C++ Workshop Barcelona 2024</h1>
                <p>Presentert av Teodor Spæren</p>
            </section>

            <section>
                <h1>Gjør c++ enklere</h1>
                <p>
                    <q>Within C++, there is a much smaller and cleaner
                        language struggling to get out</q>
                <p>Bjarne Stroustrup</p>
                </p>

                <aside class="notes">
                    Målet med talken er å gi noen innsikt i ting dere kan ta med hjem og
                    bruke til å gjøre koden deres enklere. Derfor vil noen av tingene være
                    veldig surface level, for å gi dere nok info til å vite om dere
                    trenger å bruke mer energi på dette.
                  </aside>
                </section>
            </section>

            <section>
                <h2>Innhold</h2>
                <ul>
                    <li>🔥Lambdaer🔥</li>
                    <li>Memory managment 👀</li>
                    <li><code>emplace</code></li>
                    <li><code>if</code> variabler</li>
                    <li>🔥Concepts🔥</li>
                    <li><code>std::string_view</code></li>
                    <li>Ranges</li>
                    <li>Ting som gjør livet vansklig</li>
                    <li>Optimalisering (hvis vi rekker...)</li>
                </ul>
            </section>
            <section>
                <h1>Lambdaer</h1>
            </section>

            <section>
                <h2>Lambdaer</h2>
                <ul>
                    <li>Siden C++11</li>
                    <li>Anonyme funksjoner, definert inline</li>
                    <li>Utrolig nyttige!</li>
                </ul>
            </section>

            <section>
                <section>
                    <h3>Lambda syntax - Basics</h3>
                    <pre><code data-trim class="language-cpp" data-line-numbers="|1|3|6">
                        auto funcName = [](int a, int b) {
                            std::cout << "Hello: " << a << " and " << b << "\n";
                            return a + b + 2;
                        };

                        int out = funcName(10, 23);
                    </code></pre>
                </section>

                <section>
                    <h3>Lambda syntax - Captures I</h3>
                    <pre><code data-trim class="language-cpp" data-line-numbers="|1|2|3|6-8|9-10">
                        int byRef = 0;
                        auto funcName = [&byRef]() {
                            std::cout << "ref = " << ++byRef << "\n";
                        };

                        funcName(); // ref = 1
                        funcName(); // ref = 2
                        std::cout <<  byRef << "\n"; // Outside = 2
                        byRef = 10;
                        funcName(); // ref = 11
                    </code></pre>
                </section>

                <section>
                    <h3>Lambda syntax - Captures III</h3>
                    <pre><code data-trim class="language-cpp" data-line-numbers="|3">
                        int byRef = 0;
                        int byVal = 10;
                        auto funcName = [&byRef, byVal]() mutable {
                            std::cout << "ref = " << ++byRef;
                            std::cout << ", val = " << ++byVal << "\n";
                        };
                        
                        funcName(); // ref = 1, val = 11
                        funcName(); // ref = 2, val = 12
                        byRef = 10;
                        byVal = 100;
                        funcName(); // ref = 11, val = 13
                    </code></pre>
                </section>
            </section>

            <section>
                <section>
                    <h3>Noen motiverende eksempler (Noe leetcode)</h3>
                    <q>Seeing is believing</q>
                </section>
            </section>

            <section>
                <h3>Alt annet dere vil vite, se her:</h3>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/xBAduq0RGes" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                <p>C++ lambda Idioms av Timur Doumler (alt annet han gjør er også bra!)</p>
            </section>

            <section>
                <section>
                    <h2>Memory managment</h2>
                </section>
            </section>

            <section>
                <section>
                    <h2><code>emplace funksjoner</code></h2>
                    <pre><code data-trim class="language-cpp"><script type="text/template">
                        std::vector<std::pair<int,int>> points;
                        
                        points.push_back({1, 3});
                        points.push_back({true, 3});
                    </script></code></pre>
                    <p>VS</p>
                    <pre><code data-trim class="language-cpp"><script type="text/template">
                        std::vector<std::pair<int,int>> points;
                        
                        points.emplace_back(1, 3);
                        points.emplace_back(4, true);
                    </script></code></pre>
                </section>

                <section>
                    <h3>Hvorfor?</h3>
                    <ul>
                        <li>Bedre syntax</li>
                        <li>Unngår moves</li>
                        <li>Conditional moves for map!</li>
                    </ul>
                </section>

                <section>
                    <h3>Hva støtter dette?</h3>
                    <p>Alle standard bibliotek containere!</p>
                </section>

                <section>
                    <h2><code>std::map_*</code></h2>
                    <pre><code data-trim class="language-cpp"><script type="text/template">
                        std::map<int, int> dict;
                        dict.emplace(1, 3);
                    </script></code></pre>
                    <p>VS</p>
                    <pre><code data-trim class="language-cpp"><script type="text/template">
                        std::vector<std::pair<int,int>> points;
                        
                        points.emplace_back(1, 3);
                        points.emplace_back(4, true);
                    </script></code></pre>
                </section>

                <section>
                    <h3>Gotchas!</h3>
                    <p>Initializer lists har andre prioriteringer</p>
                    <pre><code data-trim class="language-cpp"><script type="text/template">
                        std::vector<std::vector<int>> nested;
                        
                        nested.push_back({3, 1});   // nested[0] = {3, 1}
                        nested.emplace_back(3, 1);  // nested[1] = {1, 1, 1};
                        nested.emplace_back({3,1}); // nested[2] = {3, 1};
                    </script></code></pre>
                </section>

            </section>

            <section>
                <section data-auto-animate>
                    <h2><code>if</code> variabler</h2>
                    <pre data-id="wow"><code data-trim class="language-cpp" data-line-numbers="|2|4-7"><script type="text/template">
                    std::string getAnswer(int x) {
                        static std::unordered_map<int, std::string> cache;

                        auto it = cache.find(x);
                        if (it != cache.end()) {
                            return it->second;
                        }
                        
                        // Some other function, not important.
                        auto ans = computeAnswer(x);

                        cache.emplace(x, ans);
                        return ans;
                    }
                </script></code></pre>
                </section>

                <section data-auto-animate>
                    <h2><code>if</code> variabler</h2>
                    <pre data-id="wow"><code data-id="wow" data-trim class="language-cpp" data-line-numbers="4-6"><script type="text/template">
                    std::string getAnswer(int x) {
                        static std::unordered_map<int, std::string> cache;

                        if (auto it = cache.find(x); it != cache.end()) {
                            return it->second;
                        }
                        
                        // Some other function, not important.
                        auto ans = computeAnswer(x);

                        cache.emplace(x, ans);
                        return ans;
                    }
                </script></code></pre>
                </section>

                <section data-auto-animate data-auto-animate-duration="0.5">
                    <h2><code>if</code> variabler</h2>
                    <pre data-id="wow"><code data-id="wow" data-trim class="language-cpp"><script type="text/template">
                        if (auto it = cache.find(x); it != cache.end()) {
                            return it->second;
                        }
                </script></code></pre>
                <ul>
                    <li>Scoper variablet</li>
                    <li>Nyttig for mye brukte navn</li>
                    <li>Tidligere destruction</li>
                </ul>
                </section>

                <section>
                    <h3>Annet eksempel</h3>
                    <pre><code data-id="wow" data-trim class="language-cpp"><script type="text/template">
                        std::unordered_map<int, int> seen;

                        // Insert or max.
                        if (auto [it, inserted] = cache.emplace(x, y); !inserted) {
                            it->second = std::max(it->second, y);
                        }
                </script></code>
                </section>
            </section>

            <section>
                <h1>Concepts</h1>
                <p>Bedre template krav</p>
            </section>

            <section>
                <h3>Motivasjon</h3>
                <ul>
                    <li>Bedre feilmeldinger</li>
                    <li>Enklere å begrense template funksjoner</li>
                    <li>Mindre press på function overloading</li>
                    <li>Compiler speed (Ikke der enda)</li>
                </ul>
            </section>


            <section>
                <section>
                    <h3>Bedre feilmeldinger</h3>
                </section>

                <section>
                    <h3>Har du vært her?</h3>
                    <p>Long template expansion block</p>
                </section>

                <section>
                    <h3>Nå er vi her</h3>
                    <p>Wrong type</p>
                </section>
            </section>


            <section>
                <h3></h3>
            </section>

            <section>
                <section>
                    <h1></h1>
                </section>
            </section>

            <section>
                <h1>Ranges</h1>
                <q>Mye kult, mye rart</q>
            </section>

            <section>
                <h1>Ranges+</h1>
                <q>Mye kult, mye rart</q>
            </section>




            <section>
                <h1>Ting som gjør livet vansklig</h1>
                <q>C++ is the language of wrong defaults</q>
            </section>

            <section>
                <h1>Optimalisering</h1>
            </section>

            <section>
                <section>
                    <h3>Råd 1: Bruk <code>.find()</code></h1>
                    <p>Hva er problemet et mulig problem her?</p>

                    <pre><code data-id="wow" data-trim class="language-cpp"  data-line-numbers="|4"><script type="text/template">
                        std::unordered_map<int, int> lastSensorTemp;
                        
                        for (const auto sensorId : sensors) {
                            if (60 < lastSensorTemp[sensorId]) {
                                raiseAlarm(sensorId);
                            } 
                        }
                </script></code></pre>
                <p class="fragment"></p>
                </section>
            </section>


        </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
        // More info about initialization & config:
        // - https://revealjs.com/initialization/
        // - https://revealjs.com/config/
        Reveal.initialize({
            hash: true,
            slideNumber: "c/t",
            controls: true,
            controlsTutorial: false,
            

            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
        });
    </script>
</body>

</html>